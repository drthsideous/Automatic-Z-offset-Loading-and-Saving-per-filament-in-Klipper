[gcode_macro SAVE_Z_ADJUST]
description: Saves the current live Z offset to the current filament type
gcode:
  {% set ftype = printer["gcode_macro FILAMENT_Z_ADJUST"].filament_type|lower %}
  {% set applied_offset = printer.gcode_move.homing_origin.z|float %}

  SAVE_VARIABLE VARIABLE={ftype ~ "_z_offset"} VALUE={applied_offset}
  {action_respond_info("âœ… Z offset saved for %s: %.3f mm" % (ftype, applied_offset))}
